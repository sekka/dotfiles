---
name: copilot-review
description: GitHub Copilotを使用してコードレビューを実施します。GitHubとの親和性を活かし、実践的なコード改善提案を提供します。
allowed-tools: Bash, Read, Grep, Glob
---

# GitHub Copilot レビュー

GitHub Copilotを使用して、実践的なコードレビューと改善提案を実施します。

## 特徴

- **GitHub親和性**: GitHubのベストプラクティスに基づいた提案
- **実践的な提案**: 即座に適用可能なコード改善案
- **幅広い言語サポート**: 多数のプログラミング言語に対応
- **コンテキスト理解**: プロジェクト全体のコンテキストを考慮

## 使用場面

- GitHubでホストされているプロジェクトのレビュー
- 実践的なコード改善提案が欲しい場合
- 複数の言語が混在するプロジェクトのレビュー
- GitHubのワークフローと統合したレビュー

## 実行手順

### 1. レビュー対象の特定

Git差分を取得してレビュー対象を確認：

```bash
# 未コミット変更
git diff

# ステージング済み変更
git diff --cached

# 特定ブランチとの差分
git diff main...HEAD
```

### 2. レビュープロンプトの構築

Copilotに渡すレビュープロンプトを構築：

```
以下のコード変更をレビューしてください。

【レビュー観点】
- コード品質と可読性
- セキュリティ上の問題
- パフォーマンスの改善余地
- GitHubのベストプラクティス遵守
- テストの必要性

【変更内容】
[Git差分]

【期待する出力】
1. 問題点の指摘（優先度付き）
2. 具体的な改善案（コード例付き）
3. GitHubでの運用上の推奨事項
```

### 3. Copilot実行

```bash
copilot [構築したプロンプト]
```

または

```bash
echo "[プロンプト]" | copilot
```

### 4. 結果の整形と表示

Copilotの出力を以下の形式で整形：

```markdown
## GitHub Copilotレビュー結果

### 🔴 クリティカル（即座の対応が必要）

[Copilotが指摘した重大な問題]

### 🟡 重要（優先的に対応すべき）

[Copilotが指摘した重要な問題]

### 🟢 改善推奨（余裕があれば対応）

[Copilotが提案する改善点]

### 💡 GitHub運用上の推奨事項

[GitHubワークフロー、CI/CD、ブランチ戦略などの提案]

### 📊 総合評価

- **コード品質**: [評価]
- **セキュリティ**: [評価]
- **パフォーマンス**: [評価]
- **GitHub親和性**: [評価]
```

## 実装ガイドライン

### レビュー実行の流れ

1. **対象の特定**
   - ユーザーの指示から対象を判断（未コミット / ブランチ比較 / 特定ファイル）
   - 適切な`git diff`コマンドを実行

2. **差分の取得**
   ```bash
   # 未コミット変更の場合
   diff=$(git diff)

   # ブランチ比較の場合
   diff=$(git diff main...HEAD)

   # ステージング済みの場合
   diff=$(git diff --cached)
   ```

3. **プロンプトの構築**
   - レビュー観点を明示
   - Git差分を含める
   - 期待する出力形式を指定

4. **Copilot実行**
   ```bash
   copilot "$(cat <<EOF
   以下のコード変更をレビューしてください。

   【レビュー観点】
   - コード品質と可読性
   - セキュリティ上の問題
   - パフォーマンスの改善余地
   - GitHubのベストプラクティス遵守
   - テストの必要性

   【変更内容】
   $diff

   【期待する出力】
   1. 問題点の指摘（優先度付き：🔴クリティカル、🟡重要、🟢改善推奨）
   2. 具体的な改善案（コード例付き）
   3. GitHubでの運用上の推奨事項
   EOF
   )"
   ```

5. **結果の整形**
   - Copilotの出力を解析
   - 優先度別に分類
   - 見やすい形式で表示

## 使用例

### 基本的な使い方

```
/copilot-review

未コミット変更をレビューしてください
```

### ブランチ比較

```
/copilot-review

mainブランチとの差分をレビューしてください
```

### 特定の観点に絞ったレビュー

```
/copilot-review

セキュリティとGitHubのベストプラクティスの観点からレビューしてください
```

### 特定ファイルのレビュー

```
/copilot-review

src/auth/login.ts の変更をレビューしてください
```

## GitHub特有のレビュー観点

Copilotは以下のGitHub特有の観点も考慮します：

### CI/CD統合
- GitHub Actionsワークフローの最適化
- テスト自動化の推奨
- デプロイメントの安全性

### セキュリティ
- Dependabotアラートへの対応
- GitHub Advanced Securityの活用
- シークレット管理のベストプラクティス

### コラボレーション
- プルリクエストのテンプレート活用
- コードレビューのしやすさ
- ドキュメンテーションの充実

### ブランチ戦略
- Git Flowの遵守
- コミットメッセージの規約
- タグ付けとリリース管理

## 高度な使用法

### カスタムレビュー基準

```
/copilot-review

以下の基準でレビューしてください：
1. TypeScript strict modeに準拠しているか
2. React Hooksのルールを守っているか
3. アクセシビリティ（a11y）が考慮されているか
4. パフォーマンス最適化がされているか
```

### 複数ファイルの一括レビュー

```
/copilot-review

src/components/ 配下の全ての変更をレビューしてください
```

## 他のAIレビューとの連携

### 推奨ワークフロー

1. **claude-review**: クイックチェック
2. **copilot-review**: GitHub親和性の確認
3. **codex-review**: 深い論理分析
4. **gemini-review**: 別の視点での検証

### 結果の比較

複数のAIレビューを実施した場合：
- 共通して指摘された問題は優先的に対応
- AI特有の提案は内容を吟味して選択
- 矛盾する提案がある場合は開発者が判断

## 注意事項

- GitHub Copilotの認証が必要です
- 大量の差分がある場合、プロンプトが長くなる可能性があります
- 機密情報が含まれるコードは事前に除外してください
- レビュー結果はAIによる提案であり、最終判断は開発者が行ってください
- GitHubの無料プランでは一部機能に制限がある場合があります

## トラブルシューティング

### 認証エラー

GitHub Copilotにログインしているか確認：

```bash
copilot --help
```

### プロンプトが長すぎる

差分を分割してレビュー：

```bash
# ファイル単位でレビュー
git diff path/to/file
```

### レビュー品質の向上

より具体的なレビュー観点を指定：

```
具体的なコード例を含めて、以下の観点でレビューしてください：
1. [観点1]
2. [観点2]
```
