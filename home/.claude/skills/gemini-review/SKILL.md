---
name: gemini-review
description: Google Geminiを使用してコードレビューを実施します。大規模なコンテキスト理解とGoogleの視点を活かした包括的な分析を提供します。
allowed-tools: Bash, Read, Grep, Glob
---

# Google Gemini レビュー

Google Geminiを使用して、大規模コンテキスト理解とGoogleのベストプラクティスに基づいたコードレビューを実施します。

## 特徴

- **大規模コンテキスト**: 広範なコード変更を一度にレビュー可能
- **Googleの視点**: Google流の開発プラクティスに基づいた提案
- **マルチモーダル**: コード、ドキュメント、図表を総合的に分析
- **高度な推論**: 複雑なロジックやアーキテクチャの深い理解

## 使用場面

- 大規模なリファクタリングのレビュー
- Googleのベストプラクティスに沿った開発
- アーキテクチャレベルの設計判断
- 複雑なビジネスロジックの検証
- 広範なコードベースの影響分析

## 実行手順

### 1. レビュー対象の特定

Git差分または特定のファイル群を特定：

```bash
# 未コミット変更
git diff

# ブランチ間の差分
git diff main...HEAD

# 特定ディレクトリの変更
git diff -- src/
```

### 2. レビュープロンプトの構築

Geminiに渡すレビュープロンプトを構築：

```
以下のコード変更を包括的にレビューしてください。

【レビュー観点】
1. アーキテクチャ設計の妥当性
2. スケーラビリティとパフォーマンス
3. セキュリティとプライバシー
4. コード品質とベストプラクティス
5. テスト戦略の妥当性
6. ドキュメンテーションの充実度

【コンテキスト】
- プロジェクト種別: [Web / Mobile / API / etc]
- 想定規模: [ユーザー数、データ量など]
- 技術スタック: [言語、フレームワーク、インフラ]

【変更内容】
[Git差分]

【期待する分析】
1. アーキテクチャレベルの評価
2. Google流ベストプラクティスとの比較
3. スケーラビリティの観点からの懸念事項
4. セキュリティリスクの評価
5. 具体的な改善提案（優先度付き）
```

### 3. Gemini実行

```bash
gemini "$(cat <<EOF
[構築したプロンプト]
EOF
)"
```

または

```bash
gemini "[プロンプト]"
```

### 4. 結果の整形と表示

Geminiの出力を以下の形式で整形：

```markdown
## Google Geminiレビュー結果

### 🏗️ アーキテクチャ評価

[設計の妥当性、スケーラビリティ、将来の拡張性]

### 🔴 クリティカル（即座の対応が必要）

[重大な問題、セキュリティリスク、データ整合性の問題]

### 🟡 重要（優先的に対応すべき）

[パフォーマンス問題、ベストプラクティス違反、保守性の問題]

### 🟢 改善推奨（余裕があれば対応）

[コード品質向上、リファクタリング提案、最適化の余地]

### 📐 Google流ベストプラクティス

[Googleの開発スタイルガイド、デザインパターン、推奨事項]

### 📊 スケーラビリティ分析

- **現在の設計**: [評価]
- **想定負荷への対応**: [評価]
- **ボトルネックの可能性**: [指摘]

### 🔒 セキュリティ評価

- **認証・認可**: [評価]
- **データ保護**: [評価]
- **脆弱性リスク**: [評価]

### 💡 推奨アクション

1. [最優先事項]
2. [次に対応すべき事項]
3. [長期的な改善事項]
```

## 実装ガイドライン

### レビュー実行の流れ

1. **対象とコンテキストの特定**
   ```bash
   # プロジェクト情報の収集
   ls -la
   cat package.json  # または requirements.txt, go.mod など
   git log --oneline -10
   ```

2. **差分の取得**
   ```bash
   # 変更内容の取得
   diff=$(git diff)

   # または特定範囲
   diff=$(git diff main...HEAD)
   ```

3. **コンテキスト情報の収集**
   - プロジェクトの種類
   - 使用技術
   - 想定規模
   - 既存のアーキテクチャパターン

4. **包括的プロンプトの構築**
   ```bash
   gemini "$(cat <<EOF
   以下のコード変更を、Googleのベストプラクティスに基づいて包括的にレビューしてください。

   【プロジェクトコンテキスト】
   - 種別: $project_type
   - 技術: $tech_stack
   - 規模: $scale

   【レビュー観点】
   1. アーキテクチャ設計（スケーラビリティ、疎結合、単一責任）
   2. パフォーマンス（計算量、メモリ使用、I/O効率）
   3. セキュリティ（OWASP Top 10、データ保護、認証）
   4. コード品質（可読性、保守性、テスタビリティ）
   5. Google流スタイルガイド準拠
   6. テスト戦略

   【変更内容】
   $diff

   【期待する出力】
   - アーキテクチャレベルの評価
   - 優先度付き問題点（🔴🟡🟢）
   - 具体的な改善案（コード例付き）
   - Googleベストプラクティスとの比較
   - スケーラビリティ懸念事項
   EOF
   )"
   ```

5. **結果の解析と整形**
   - Geminiの出力を解析
   - アーキテクチャ、セキュリティ、パフォーマンスなど分野別に整理
   - 優先度を明確化

## 使用例

### 基本的な使い方

```
/gemini-review

未コミット変更を包括的にレビューしてください
```

### アーキテクチャ重視のレビュー

```
/gemini-review

アーキテクチャとスケーラビリティの観点から、mainブランチとの差分をレビューしてください
```

### セキュリティ重視のレビュー

```
/gemini-review

セキュリティとプライバシーの観点から、認証関連の変更をレビューしてください
```

### 大規模リファクタリングのレビュー

```
/gemini-review

以下のリファクタリングの妥当性を評価してください：
- モノリスからマイクロサービスへの分割
- データベーススキーマの変更
- APIインターフェースの変更
```

## Google流ベストプラクティスの観点

Geminiは以下のGoogle特有の観点も考慮します：

### コーディングスタイル
- Googleスタイルガイド準拠（各言語）
- 命名規則の一貫性
- コメント・ドキュメンテーション

### 設計原則
- SOLID原則の適用
- デザインパターンの適切な使用
- 疎結合・高凝集

### スケーラビリティ
- 水平スケーリングへの対応
- キャッシング戦略
- 非同期処理の活用

### 信頼性
- エラーハンドリング
- リトライロジック
- 冪等性の確保

### 観測可能性
- ログ出力の適切性
- メトリクス収集
- トレーシング

### テスト戦略
- ユニットテストのカバレッジ
- 統合テストの必要性
- エンドツーエンドテスト

## 高度な使用法

### マルチファイル分析

```
/gemini-review

以下のファイル群の変更を、相互関連性を考慮してレビューしてください：
- src/api/auth.ts
- src/middleware/session.ts
- src/models/user.ts
- tests/api/auth.test.ts
```

### パフォーマンス分析

```
/gemini-review

以下の変更が100万ユーザー規模でのパフォーマンスに与える影響を分析してください
```

### 移行計画のレビュー

```
/gemini-review

以下の技術スタック移行計画の妥当性を評価してください：
- 移行前: [技術スタック]
- 移行後: [技術スタック]
- 移行戦略: [段階的移行 / ビッグバン / etc]
```

## 他のAIレビューとの連携

### 推奨ワークフロー

1. **claude-review**: 初期のクイックチェック
2. **gemini-review**: アーキテクチャと全体設計の評価
3. **codex-review**: ロジックの詳細分析
4. **copilot-review**: 実践的な改善提案

### Geminiが特に有効な場面

- **大規模変更**: 広範なコンテキストを一度に処理
- **アーキテクチャ判断**: 設計レベルの妥当性評価
- **複雑なロジック**: 高度な推論が必要な分析
- **スケーラビリティ**: 将来の成長を見据えた評価

## 注意事項

- Gemini CLIの認証が必要です（初回実行時に認証プロセスが開始されます）
- 非常に大量の差分がある場合、コンテキストが広いため処理に時間がかかる可能性があります
- 機密情報が含まれるコードは事前に除外してください
- レビュー結果はAIによる提案であり、最終判断は開発者が行ってください
- Geminiのモデルバージョンによって能力が異なる場合があります

## トラブルシューティング

### 認証エラー

Gemini CLIの認証状態を確認：

```bash
gemini --help
```

初回実行時は自動的に認証プロセスが開始されます。

### プロンプトが長すぎる

差分を論理的な単位に分割：

```bash
# ディレクトリ単位
git diff -- src/api/

# ファイル単位
git diff -- src/api/auth.ts
```

### レビュー品質の向上

より詳細なコンテキストを提供：

```
プロジェクトの背景：
- ユーザー規模: 100万人
- 主要機能: [機能説明]
- 現在の課題: [課題説明]

上記を踏まえて、以下の変更をレビューしてください：
[差分]
```

### モデルの選択

特定のGeminiモデルを使用：

```bash
gemini -m gemini-2.0-flash-exp "レビュープロンプト"
```
