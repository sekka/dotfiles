# 共通ルール

## 基本原則

- ユーザーとの対話には日本語を使用する
- ユーザーの指示なく、以下の作業を行わない
  - 次のタスクを開始
  - Gitコミット
  - GitHubにプッシュ

## 環境ツール使用ルール

- ファイル、コード、シェル操作のすべてについて、必ず環境ツールのみを使用する（例外なし）
- `~/.ssh`にアクセスしない
- `environment_run_cmd`ツールでgit CLIをインストールしたり使用しない
  - すべての環境ツールがGit操作を処理するため
  - 手動で`.git`を変更すると環境の整合性が損なわれる
- 作業内容を確認する方法として`container-use log <env_id>`と`container-use checkout <env_id>`の使用方法をユーザーに必ず伝える

## 情報収集・調査ルール

- すべて公開情報に基づき、一次ソース（公式ドキュメント、GitHub実装等）を優先する
- 推測は原則しない。必要な場合は推測であることを明記する
- 不明な情報は推測せず、不明であると明記する
- 実装で技術的に詰まった場合はGemini MCPかO3 MCPに英語で相談する
- フレームワークの利用方法は現在のバージョン情報をもとにContext7 MCPで調べる

## コード作成ルール

- 生成するコードは、コメントを多めに入れて解説する

### コード品質

- 関数は集中して小さく保つ
- 既存のパターンを正確に踏襲する
- 行の最大長は100文字まで

## Git・GitHubルール

### コミット管理

- コミットメッセージには`chore`、`fix`、`feat`、`docs`のいずれかのプレフィックスを使用する
- コミットメッセージにはAI署名を含めない
- コミットメッセージは日本語で何をなぜ変更したのか記載する
- 非常に小さい粒度で定期的にコミットする
- Pushする前にローカルでlint、test、typecheckが成功することを確認する
- CIにエラーがある限りPRはマージしない

### ブランチ・PR管理

- ブランチ名：`feat/issue-1`、`fix/issue-2`等（プレフィックス + Issue番号）
- PRタイトル：`fix: issue-1 開発環境のサーバーエラーを解決`
- PRコメント内でIssueを関連づけ、マージ時にCloseされるよう記載する

## Playwright MCP使用ルール

### 絶対的な禁止事項

#### 1. いかなる形式のコード実行も禁止

- Python、JavaScript、Bash等でのブラウザ操作
- MCPツールを調査するためのコード実行
- subprocessやコマンド実行によるアプローチ

#### 2. 利用可能なのはMCPツールの直接呼び出しのみ

- `playwright:browser_navigate`
- `playwright:browser_screenshot`
- 他のPlaywright MCPツール

#### 3. エラー時は即座に報告

- 回避策を探さない
- 代替手段を実行しない
- エラーメッセージをそのまま伝える
