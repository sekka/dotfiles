---
description: 指定ファイルのコードレビュー
argument-hint: [対象ファイルまたはディレクトリ]
---

# コードレビュー

対象: $ARGUMENTS

## 実行内容

### Step 1: 概要把握

- 変更の目的を理解
- 変更されたファイルの一覧を確認
- 関連する Issue や PR の説明を確認

### Step 2: コードレビュー

以下の観点でレビュー：

#### 正確性

- [ ] ロジックが正しいか
- [ ] エッジケースが考慮されているか
- [ ] エラーハンドリングが適切か
- [ ] null/undefined の扱いが安全か

#### セキュリティ

- [ ] 入力値のバリデーション
- [ ] SQL インジェクション対策
- [ ] XSS 対策
- [ ] 認証/認可のチェック
- [ ] 機密情報のハードコーディングがないか

#### パフォーマンス

- [ ] 不要な計算や再レンダリングがないか
- [ ] N+1 問題がないか
- [ ] メモリリークの可能性がないか
- [ ] 適切なインデックスが使われているか

#### 保守性

- [ ] コードが読みやすいか
- [ ] 命名が適切か
- [ ] 適切な抽象化レベルか
- [ ] 重複コードがないか
- [ ] コメントが適切か（過不足なく）

#### テスタビリティ

- [ ] テストが追加されているか
- [ ] テストカバレッジは十分か
- [ ] テストが保守しやすいか

#### 設計

- [ ] SOLID 原則に従っているか
- [ ] 既存のアーキテクチャに沿っているか
- [ ] 依存関係の方向が適切か

### Step 3: レビュー結果の報告

```markdown
## レビュー結果

### サマリー

- 全体的な印象
- 特に良かった点
- 改善が必要な点の概要

### 詳細

| #   | ファイル | 行  | 種別 | 重要度 | 指摘内容 | 提案 |
| --- | -------- | --- | ---- | ------ | -------- | ---- |
| 1   | xxx.ts   | 42  | バグ | 高     | ...      | ...  |
| 2   | yyy.ts   | 15  | 改善 | 中     | ...      | ...  |
| 3   | zzz.ts   | 8   | 質問 | 低     | ...      | ...  |

### 種別の説明

- **バグ**: 明らかな問題（必須修正）
- **セキュリティ**: セキュリティ上の問題（必須修正）
- **パフォーマンス**: パフォーマンスの問題
- **改善**: より良い書き方の提案
- **質問**: 意図の確認
- **nitpick**: 些細な指摘（修正は任意）
```

## レビューコメントの書き方

### 良いコメントの例

```markdown
<!-- 具体的な理由と改善案を示す -->

この条件分岐では `user` が null の場合を考慮していません。
`user?.name` のようにオプショナルチェーンを使うか、
事前に null チェックを追加することを推奨します。

<!-- コードの意図を確認する -->

この処理を同期的に行っている理由はありますか？
非同期にすることでパフォーマンスが改善できる可能性があります。
```

### 避けるべきコメント

```markdown
<!-- 曖昧すぎる -->

❌ "ここは良くない"

<!-- 具体的な改善案がない -->

❌ "これはリファクタリングすべき"

<!-- 上から目線 -->

❌ "こんなコードを書くべきではない"
```

## 重要度の基準

| 重要度 | 基準                                       | 対応     |
| ------ | ------------------------------------------ | -------- |
| 高     | バグ、セキュリティ問題、データ損失の可能性 | 必須修正 |
| 中     | パフォーマンス問題、保守性の低下           | 強く推奨 |
| 低     | コードスタイル、軽微な改善                 | 任意     |

## 注意事項

- 批判ではなく建設的なフィードバックを心がける
- 良い点も積極的に伝える
- 「なぜ」を説明し、学びの機会を提供する
- 緊急でない指摘は nitpick として明示する
- 全体の文脈を理解してからレビューする
