---
description: エラーの原因調査と修正提案
argument-hint: [エラーメッセージまたは問題の説明]
---

# デバッグ

問題: $ARGUMENTS

## 実行内容

### Step 1: 情報収集

#### エラーメッセージの解析

- エラータイプ（TypeError, SyntaxError, NetworkError 等）
- スタックトレースの確認
- 発生箇所の特定

#### 再現条件の確認

- どの操作で発生するか
- 発生頻度（常に/時々/特定条件下）
- 環境依存性（開発/本番、ブラウザ/Node.js）

### Step 2: 仮説の立案

考えられる原因を列挙：

```markdown
| #   | 仮説 | 可能性   | 検証方法 |
| --- | ---- | -------- | -------- |
| 1   | ...  | 高/中/低 | ...      |
```

### Step 3: 検証

仮説を一つずつ検証：

1. 関連するコードを読む
2. ログを追加して状態を確認
3. デバッガーでステップ実行
4. 最小再現コードを作成

### Step 4: 根本原因の特定

- 直接的な原因
- 根本的な原因（なぜその状態になったか）
- 類似の問題が他にないか確認

### Step 5: 修正提案

```markdown
## 修正案

### 原因

...

### 修正内容

...

### 影響範囲

...

### 再発防止策

...
```

### Step 6: 修正と検証（承認後）

1. 修正を実装
2. 問題が解決したことを確認
3. 関連するテストを追加
4. 既存テストがパスすることを確認

## デバッグテクニック

### ログ出力

```typescript
// 状態の確認
console.log("変数名:", JSON.stringify(変数, null, 2));

// タイミングの確認
console.time("処理名");
// ...処理...
console.timeEnd("処理名");

// スタックトレース
console.trace("ここまでの呼び出し");
```

### 分割統治法

1. 問題が発生する範囲を半分に絞る
2. どちらで問題が発生するか確認
3. 繰り返して原因箇所を特定

### 差分デバッグ

- 正常に動作していた時点のコードと比較
- `git bisect` で問題が混入したコミットを特定

### ラバーダック・デバッグ

- 問題を言語化して説明する
- 説明する過程で気づきを得る

## よくある原因

### JavaScript/TypeScript

- `null`/`undefined` へのアクセス
- 非同期処理の順序
- スコープの問題（クロージャ、this）
- 型の不一致
- 配列/オブジェクトの参照

### React

- 無限レンダリングループ
- 依存配列の不足
- 状態の非同期更新
- キーの重複/欠落

### ネットワーク

- CORS エラー
- 認証/認可の問題
- タイムアウト
- レスポンス形式の不一致

## 注意事項

- 推測で修正せず、原因を特定してから修正
- 修正後は必ず再現テストを行う
- デバッグ用のコード（console.log 等）は最終的に削除
- 根本原因を修正し、対症療法に頼らない
