# Zsh & Tmux チートシート

このドキュメントは dotfiles で設定されているコマンド、キーバインド、エイリアスの一覧です。

## 目次

- [Zsh](#zsh)
  - [キーバインド](#zsh-キーバインド)
  - [カスタム関数](#zsh-カスタム関数)
  - [エイリアス](#zsh-エイリアス)
  - [便利なコマンド](#zsh-便利なコマンド)
- [Tmux](#tmux)
  - [基本操作](#tmux-基本操作)
  - [ウィンドウ操作](#tmux-ウィンドウ操作)
  - [ペイン操作](#tmux-ペイン操作)
  - [コピーモード](#tmux-コピーモード)
  - [Popup ウィンドウ](#tmux-popup-ウィンドウ)
  - [プラグイン](#tmux-プラグイン)

---

## Zsh

### Zsh キーバインド

| キー     | 機能             | 説明                                        |
| -------- | ---------------- | ------------------------------------------- |
| `Ctrl+R` | 履歴検索         | コマンド履歴を fzf でインタラクティブに検索 |
| `Ctrl+]` | リポジトリ移動   | ghq で管理されているリポジトリに移動        |
| `Ctrl+G` | ブランチ切り替え | Git ブランチを fzf で選択してチェックアウト |
| `Ctrl+H` | ウィジェット選択 | anyframe のウィジェット選択                 |
| `Ctrl+J` | ブランチ挿入     | Git ブランチ名を挿入                        |

### Zsh カスタム関数

#### ディレクトリ・ファイル操作

| コマンド                | 説明                              | 使用例                  |
| ----------------------- | --------------------------------- | ----------------------- |
| `fcd [dir]`             | ディレクトリを fzf で選択して移動 | `fcd ~/projects`        |
| `path_show`             | PATH を改行区切りで表示           | `path_show`             |
| `check_path_duplicates` | PATH の重複エントリを表示         | `check_path_duplicates` |
| `optimize_path`         | PATH から重複を削除               | `optimize_path`         |

#### Git 操作

| コマンド | 説明                                    | 使用例  |
| -------- | --------------------------------------- | ------- |
| `fbr`    | ローカルブランチを fzf で選択           | `fbr`   |
| `fbrm`   | リモートブランチを含めて選択            | `fbrm`  |
| `fgco`   | Git checkout（fbr のエイリアス）        | `fgco`  |
| `fgcor`  | Git checkout リモート含む               | `fgcor` |
| `gifit`  | コミット範囲を選択して difit で差分確認 | `gifit` |

#### 開発ツール

| コマンド | 説明                                | 使用例 |
| -------- | ----------------------------------- | ------ |
| `prun`   | npm スクリプトを fzf で選択して実行 | `prun` |
| `mrun`   | mise タスクを fzf で選択して実行    | `mrun` |

### Zsh エイリアス

#### ファイル操作

| エイリアス | コマンド               | 説明                 |
| ---------- | ---------------------- | -------------------- |
| `l`        | `eza`                  | ファイル一覧         |
| `lsa`      | `eza --long --all ...` | 詳細ファイル一覧     |
| `tree`     | `tree -NC`             | ツリー表示           |
| `rm`       | `rm -i`                | 削除時に確認         |
| `cp`       | `cp -i`                | コピー時に確認       |
| `mv`       | `mv -i`                | 移動時に確認         |
| `mkdir`    | `mkdir -p`             | 親ディレクトリも作成 |

#### 開発

| エイリアス   | コマンド                  | 説明                        |
| ------------ | ------------------------- | --------------------------- |
| `be`         | `bundle exec`             | Bundler 経由で実行          |
| `sudo`       | `sudo`                    | エイリアス展開を有効化      |
| `claude-mem` | `bun "$HOME/.claude/..."` | Claude メモリプラグイン起動 |

#### 検索

| エイリアス | コマンド                           | 説明                |
| ---------- | ---------------------------------- | ------------------- |
| `ag`       | `ag --smart-case --stats ...`      | The Silver Searcher |
| `agh`      | `ag --hidden ...`                  | 隠しファイルも検索  |
| `rg`       | `rg --smart-case --stats --pretty` | ripgrep             |

#### セッション管理

| エイリアス | コマンド      | 説明                |
| ---------- | ------------- | ------------------- |
| `t`        | `tmux`        | tmux 起動           |
| `td`       | `tmux detach` | tmux デタッチ       |
| `tm`       | `tmuximum`    | tmux セッション選択 |

#### ディレクトリナビゲーション

| エイリアス | コマンド      | 説明       |
| ---------- | ------------- | ---------- |
| `..`       | `cd ..`       | 1 階層上へ |
| `...`      | `cd ../..`    | 2 階層上へ |
| `....`     | `cd ../../..` | 3 階層上へ |

#### グローバルエイリアス（パイプで使用）

| エイリアス | コマンド        | 説明                   | 使用例          |
| ---------- | --------------- | ---------------------- | --------------- |
| `L`        | `\| less -F -R` | less で表示            | `cat file L`    |
| `H`        | `\| head`       | 先頭を表示             | `ls H`          |
| `T`        | `\| tspin -f`   | tspin で整形           | `cat log T`     |
| `G`        | `\| grep`       | grep で検索            | `ls G pattern`  |
| `C`        | `\| pbcopy`     | クリップボードにコピー | `echo "text" C` |

#### Git エイリアス

| エイリアス | コマンド                | 説明                 |
| ---------- | ----------------------- | -------------------- |
| `gft`      | `git fetch`             | フェッチ             |
| `gpl`      | `git pull`              | プル                 |
| `gco`      | `git checkout`          | チェックアウト       |
| `gst`      | `git status`            | ステータス           |
| `gcm`      | `git commit -a`         | 全変更をコミット     |
| `gbr`      | `git branch`            | ブランチ一覧         |
| `gba`      | `git branch -a`         | 全ブランチ一覧       |
| `gbm`      | `git branch --merged`   | マージ済みブランチ   |
| `gbn`      | `git branch --no-merge` | 未マージブランチ     |
| `gstt`     | `git status -uno`       | 未追跡ファイルを除外 |
| `gdiff`    | `git diff --word-diff`  | 単語単位の差分       |

#### fzf 連携スクリプト

| エイリアス | コマンド          | 説明                    |
| ---------- | ----------------- | ----------------------- |
| `fshow`    | `git-fzf-show.ts` | Git ログを fzf で表示   |
| `fadd`     | `git-fzf-add.ts`  | Git add を fzf で実行   |
| `fssh`     | `fzf-ssh.ts`      | SSH 接続先を fzf で選択 |

### Zsh 便利なコマンド

#### 標準 Zsh コマンド

| コマンド      | 説明                                 | 使用例       |
| ------------- | ------------------------------------ | ------------ |
| `cd -`        | 前のディレクトリに戻る               | `cd -`       |
| `dirs -v`     | ディレクトリスタック表示             | `dirs -v`    |
| `pushd <dir>` | ディレクトリをスタックに追加して移動 | `pushd /tmp` |
| `popd`        | スタックから取り出して移動           | `popd`       |
| `!!`          | 直前のコマンドを実行                 | `sudo !!`    |
| `!$`          | 直前のコマンドの最後の引数           | `cat !$`     |
| `fc`          | コマンド履歴をエディタで編集         | `fc`         |

#### プラグイン提供のコマンド

| コマンド       | 説明                   | 提供元    |
| -------------- | ---------------------- | --------- |
| `z <keyword>`  | ディレクトリジャンプ   | enhancd   |
| `emoji`        | 絵文字を fzf で選択    | emoji-cli |
| `forgit::log`  | Git ログを fzf で表示  | forgit    |
| `forgit::diff` | Git diff を fzf で表示 | forgit    |

---

## Tmux

### Tmux 基本操作

**Prefix キー: `Ctrl+A`**

| キー       | 機能             | 説明                        |
| ---------- | ---------------- | --------------------------- |
| `Prefix r` | 設定リロード     | `~/.tmux.conf` を再読み込み |
| `Prefix ?` | キーバインド一覧 | 全キーバインドを表示        |
| `Prefix d` | デタッチ         | tmux セッションから離脱     |

### Tmux ウィンドウ操作

| キー           | 機能             | 説明                             |
| -------------- | ---------------- | -------------------------------- |
| `Prefix n`     | 新ウィンドウ作成 | 新しいウィンドウを作成           |
| `Prefix Space` | ウィンドウ選択   | ウィンドウ選択画面を表示         |
| `Prefix C-h`   | 前のウィンドウ   | 前のウィンドウに移動（連打可能） |
| `Prefix C-l`   | 次のウィンドウ   | 次のウィンドウに移動（連打可能） |
| `Prefix C`     | ウィンドウ終了   | 現在のウィンドウを終了           |
| `Prefix ,`     | ウィンドウ名変更 | ウィンドウの名前を変更           |
| `Prefix 0-9`   | ウィンドウ移動   | 指定番号のウィンドウに移動       |

### Tmux ペイン操作

#### ペイン分割

| キー        | 機能         | 説明                               |
| ----------- | ------------ | ---------------------------------- |
| `Prefix \|` | 縦分割       | ペインを縦に分割                   |
| `Prefix -`  | 横分割       | ペインを横に分割                   |
| `Prefix b`  | ペインを独立 | ペインを新しいウィンドウとして分離 |
| `Prefix c`  | ペイン終了   | 現在のペインを終了                 |

#### ペイン移動

| キー       | 機能           | 説明                  |
| ---------- | -------------- | --------------------- |
| `Prefix h` | 左のペイン     | 左のペインに移動      |
| `Prefix j` | 下のペイン     | 下のペインに移動      |
| `Prefix k` | 上のペイン     | 上のペインに移動      |
| `Prefix l` | 右のペイン     | 右のペインに移動      |
| `Shift+↑`  | 上のペイン     | Prefix なしで上に移動 |
| `Shift+↓`  | 下のペイン     | Prefix なしで下に移動 |
| `Shift+←`  | 左のペイン     | Prefix なしで左に移動 |
| `Shift+→`  | 右のペイン     | Prefix なしで右に移動 |
| `Prefix i` | ペイン番号表示 | ペイン番号を表示      |

#### ペインリサイズ

| キー       | 機能     | 説明                            |
| ---------- | -------- | ------------------------------- |
| `Prefix H` | 左に拡大 | ペインを左に 5 拡大（連打可能） |
| `Prefix J` | 下に拡大 | ペインを下に 5 拡大（連打可能） |
| `Prefix K` | 上に拡大 | ペインを上に 5 拡大（連打可能） |
| `Prefix L` | 右に拡大 | ペインを右に 5 拡大（連打可能） |

### Tmux コピーモード

**Vi キーバインド有効**

#### 基本操作

| キー       | 機能             | 説明                             |
| ---------- | ---------------- | -------------------------------- |
| `Prefix v` | コピーモード開始 | スクロールバックバッファを閲覧   |
| `Esc`      | コピーモード終了 | コピーモードを終了               |
| `v`        | 選択開始         | テキスト選択を開始               |
| `Space`    | 選択開始         | テキスト選択を開始               |
| `V`        | 行選択           | 行単位で選択                     |
| `Ctrl+V`   | 矩形選択         | 矩形選択モード                   |
| `y`        | コピー           | 選択範囲をクリップボードにコピー |
| `Enter`    | コピー           | 選択範囲をクリップボードにコピー |

#### 移動（Vi キーバインド）

| キー       | 機能              | 説明                      |
| ---------- | ----------------- | ------------------------- |
| `h/j/k/l`  | カーソル移動      | 左/下/上/右に移動         |
| `w/b`      | 単語移動          | 次の単語/前の単語         |
| `0/$`      | 行頭/行末         | 行頭/行末に移動           |
| `gg/G`     | バッファ先頭/末尾 | バッファの先頭/末尾に移動 |
| `Ctrl+U/D` | スクロール        | 半ページ上/下にスクロール |
| `/`        | 検索              | 前方検索                  |
| `?`        | 逆検索            | 後方検索                  |
| `n/N`      | 次/前の検索結果   | 検索結果間を移動          |

### Tmux Popup ウィンドウ

**画面の 95% サイズで中央に popup 表示**

| キー            | 機能          | 説明                             |
| --------------- | ------------- | -------------------------------- |
| `Prefix Ctrl+P` | シェル popup  | カレントディレクトリで新規シェル |
| `Prefix Ctrl+U` | GitUI popup   | GitUI を popup 表示              |
| `Prefix Ctrl+Y` | Lazygit popup | Lazygit を popup 表示            |
| `Prefix Ctrl+T` | Tig popup     | Tig（Git 履歴）を popup 表示     |
| `Prefix Ctrl+N` | Navi popup    | コマンドチートシートを表示       |

**Popup 内での操作:**

- `Ctrl+C` or `exit`: Popup を閉じる

### Tmux プラグイン

#### tmux-sessionx

| キー       | 機能           | 説明                                 |
| ---------- | -------------- | ------------------------------------ |
| `Prefix O` | セッション選択 | セッション・ウィンドウを対話的に選択 |

**機能:**

- セッション一覧表示
- ウィンドウモードでの全ウィンドウ表示
- プレビュー表示（80%）
- 新規セッション作成
- セッション削除

#### tmux-fzf

| キー       | 機能         | 説明                                        |
| ---------- | ------------ | ------------------------------------------- |
| `Prefix F` | fzf メニュー | セッション・ウィンドウ・ペインを fzf で選択 |

---

## 便利な組み合わせ

### Zsh + Tmux ワークフロー

1. **リポジトリに移動してセッション作成**
   ```bash
   Ctrl+]  # リポジトリを fzf で選択
   tm      # tmux セッションを選択/作成
   ```

2. **Git ワークフロー**
   ```bash
   Prefix Ctrl+Y    # Lazygit を popup で起動
   # または
   fbr                # ブランチを fzf で選択
   fadd               # 変更を fzf で選択して add
   gcm                # コミット
   ```

3. **開発ワークフロー**
   ```bash
   Prefix |           # ペイン縦分割
   Prefix -           # ペイン横分割
   prun               # npm スクリプト実行
   mrun               # mise タスク実行
   ```

4. **履歴活用**
   ```bash
   Ctrl+R             # コマンド履歴を fzf で検索
   !!                 # 直前のコマンド実行
   sudo !!            # 直前のコマンドを sudo で実行
   ```

---

## デバッグ・トラブルシューティング

### Zsh

```bash
# PATH の確認
path_show

# PATH の重複確認
check_path_duplicates

# PATH の最適化
optimize_path

# zsh の設定をリロード
source ~/.zshrc
```

### Tmux

```bash
# tmux の設定をリロード
Prefix r

# 全キーバインドを確認
Prefix ?

# セッション一覧
tmux ls

# セッションにアタッチ
tmux attach -t <session-name>
```

---

## 参考リンク

- **Zsh 公式ドキュメント**: https://zsh.sourceforge.io/Doc/
- **Tmux 公式ドキュメント**: https://github.com/tmux/tmux/wiki
- **fzf GitHub**: https://github.com/junegunn/fzf
- **ghq GitHub**: https://github.com/x-motemen/ghq
